# C言語入門

##  対応C規格

- **主要対象:** 全規格共通
- **学習内容:** C言語の基礎知識、開発環境構築、規格解説

##  学習目標
この章を完了すると、以下のことができるようになります。

- C言語の特徴と歴史を理解する
- 開発環境を構築し、基本的なコンパイル手順を覚える
- C言語の規格（C90, C99, C11, C17）の違いを理解する
- 簡単なプログラムをコンパイル・実行できる

##  概要と詳細

### C言語とは 
C言語は1972年にデニス・リッチーがベル研究所で開発したプログラミング言語です。現在でも世界中で広く使われている、とても重要なプログラミング言語の一つです。

#### なぜC言語を学ぶのか？

初めてプログラミングを学ぶ方は「なぜC言語から始めるの？」と思うかもしれません。実は、C言語を学ぶことには大きなメリットがあります。

1. **コンピュータの仕組みが理解できる**

   - C言語はコンピュータのハードウェアに近い言語です
   - メモリやCPUがどのように動作するか実感できます
   - 他の言語を学ぶときの基礎知識になります

2. **多くのプログラミング言語の元になっている**

   - C++、Java、C#などはC言語の影響を受けています
   - C言語の文法を知っていれば、他の言語も学びやすくなります

3. **今でも現役で使われている**

   - 50年以上の歴史がありますが、今でも重要な場面で使われています
   - 特に高速性や効率性が求められる場面では欠かせません

#### 主な特徴
C言語には以下のような特徴があります。初心者には少し難しく感じるかもしれませんが、一つずつ理解していけば大丈夫です。

- **システムプログラミング向け**: 
  - OS（オペレーティングシステム）の開発に使われます
  - ハードウェアを直接制御できます
  - 例：LinuxカーネルはC言語で書かれています
- **高い移植性**: 
  - 一度書いたプログラムが様々なコンピュータで動きます
  - Windows、Mac、Linuxなど、異なるOSでも同じコードが使えます
  - これを「Write Once, Run Anywhere（一度書けば、どこでも動く）」と言います
- **効率性**: 
  - 実行速度が非常に速い
  - メモリの使用量を最小限に抑えられる
  - 限られたリソースで動作させる必要がある場面で重宝されます
- **シンプルな文法**: 
  - 言語の機能が基本的なものに絞られています
  - 覚えることが比較的少ない
  - ただし、その分プログラマーが考えることは多くなります

#### 使用分野
C言語は以下のような分野で活躍しています。

- **オペレーティングシステム（OS）**
  - Linux：世界中のサーバーで使われているOS
  - Windows：一部のコア部分
  - macOS：カーネル部分
- **組込みシステム**
  - 家電製品（エアコン、洗濯機、電子レンジなど）
  - 自動車の制御システム
  - IoTデバイス（スマートウォッチ、センサーなど）
- **データベースシステム**
  - MySQL、PostgreSQLなどの有名なデータベース
  - 高速なデータ処理が必要なため
- **ゲームエンジン**
  - ゲームの基盤となる部分
  - 3Dグラフィックスの処理など
- **科学技術計算**
  - 物理シミュレーション
  - 数値解析
  - 機械学習の基礎ライブラリ

### C言語の規格 
C言語は時代とともに進化し、複数の規格（バージョン）が策定されています。プログラミング言語にも「バージョン」があることを不思議に思うかもしれませんが、これは言語をより使いやすく、より強力にするための改良の歴史です。

#### C言語規格の歴史

| 規格名 | 発表年 | 正式名称 | 主な特徴 |
|--------|--------|----------|----------|
| **C90** | 1990年 | ISO/IEC 9899:1990 | 初の国際標準、ANSI C |
| **C99** | 1999年 | ISO/IEC 9899:1999 | _Bool型、可変長配列、inline関数 |
| **C11** | 2011年 | ISO/IEC 9899:2011 | 匿名構造体、_Generic、マルチスレッド |
| **C17** | 2018年 | ISO/IEC 9899:2018 | C11のバグ修正版 |

#### 各規格の詳しい説明
**C90（ANSI C）**

- C言語の最初の国際標準規格です
- 最も基本的で、すべてのC言語コンパイラが対応しています
- シンプルで学習しやすく、初心者にお勧めです
- 古い組込みシステムでも確実に動作します

**C99**

- 多くの便利な機能が追加されました
- 例：forループの中で変数を宣言できるようになりました

  ```c
  for (int i = 0; i < 10; i++) { /* C99から可能 */ }
  ```

- 現在最も広く使われている規格です

**C11**

- マルチスレッド（並列処理）のサポートが追加されました
- より安全なプログラミングのための機能が強化されました
- 比較的新しいため、すべての環境で使えるとは限りません

**C17**

- C11の細かいバグを修正したマイナーアップデート
- 新機能の追加はほとんどありません

#### どの規格を選ぶべきか？
初学者の方への推奨。

- **学習目的なら**: **C90から始める**
  - 最も基本的な機能を確実に習得できます
  - どこでも動く汎用的なコードが書けるようになります
  - 段階的に新しい機能を学んでいけます

- **実用的なプログラムを書くなら**: **C99を使う**
  - 便利な機能が使えて、生産性が向上します
  - ほとんどの環境で問題なく動作します
  - 現在の業界標準と言えます

- **組込みシステムを作るなら**: **C90またはC99**
  - 使用するマイコンやコンパイラの対応状況を確認してください
  - 古い環境ではC90しか使えない場合があります

#### 規格による違いの例

```c
/* C90スタイル */
int main(void) {
    int i;  /* 変数宣言は関数の先頭で */
    
    for (i = 0; i < 10; i++) {
        printf("%d\n", i);
    }
    return 0;
}

/* C99以降のスタイル */
int main(void) {
    for (int i = 0; i < 10; i++) {  /* forループ内で宣言可能 */
        printf("%d\n", i);
    }
    return 0;
}
```
この教材では、基本的にC90準拠のコードを示し、必要に応じてC99版も提供します。これにより、どんな環境でも動作するコードの書き方を学びながら、新しい機能も理解できるようになっています。

### 開発環境 
C言語でプログラミングを始めるには、いくつかのツール（ソフトウェア）が必要です。最初は難しく感じるかもしれませんが、一度セットアップすればずっと使えます。

#### 必須ツール
プログラミングには以下の4つのツールが必要です。

1. **テキストエディター**: プログラムを書くためのソフト

   - メモ帳でも書けますが、専用エディターが便利です
   - 推奨：Visual Studio Code（無料）、Sublime Text、Atom
   - プログラミング用エディターは色分け表示などの便利機能があります

2. **コンパイラ**: 人間が書いたコードをコンピュータが理解できる形に変換

   - C言語で書いたテキストを実行可能なプログラムに変換します
   - 主なコンパイラ：GCC（無料）、Clang（無料）、Visual C++（Windows）
   - この教材ではGCCを使用します

3. **リンカー**: プログラムの部品を組み合わせる

   - 通常はコンパイラに含まれているので、別途インストールは不要です
   - 複数のファイルからなるプログラムを一つにまとめます

4. **デバッガー**: プログラムの誤り（バグ）を見つけるツール

   - プログラムを一行ずつ実行して動作を確認できます
   - GDB（GCCに付属）が一般的です

#### OS別の環境構築手順
お使いのOSに応じて、以下の手順で環境を構築してください。

**Windows:**
最も簡単な方法はMinGW-w64をインストールすることです。

1. MinGW-w64のインストーラーをダウンロード
2. インストール時の設定。

   - Architecture: x86_64（64ビット版）
   - Threads: posix
   - Exception: seh

3. 環境変数PATHにMinGWのbinフォルダを追加
4. コマンドプロンプトで `gcc --version` と入力して確認
または、Microsoft Visual Studio Community（無料）も使えます。

- C++の開発環境をインストール
- 統合開発環境（IDE）なので初心者に優しい

**macOS:**
macOSは開発者に優しいOSです。

```bash
# ターミナルを開いて以下のコマンドを実行
xcode-select --install
```
これだけで、GCCとその他の開発ツールがインストールされます。

**Linux（Ubuntu/Debian）:**
Linuxは最初から開発環境が整っていることが多いです。

```bash
# パッケージリストを更新
sudo apt update
# 開発ツール一式をインストール
sudo apt install build-essential
# 確認
gcc --version
```

#### 環境構築の確認
インストールが完了したら、以下のコマンドで確認しましょう。

```bash
# コンパイラのバージョン確認
gcc --version
# 簡単なプログラムを作成してテスト
echo 'int main(void) { return 0; }' > test.c
gcc test.c -o test
./test  # Windowsの場合は test.exe
echo $?  # 0 が表示されれば成功
```

### コンパイル手順 
C言語のプログラムが実行されるまでの流れを理解しましょう。料理に例えると。

1. **ソースコード作成**（レシピを書く）

   - 人間が理解できるC言語でプログラムを書きます
   - ファイルの拡張子は `.c` です（例：hello.c）

2. **プリプロセッサ処理**（材料の下準備）

   - `#include` で指定したファイルを取り込みます
   - `#define` で定義した値を置き換えます
   - コンパイラが処理する前の準備作業です

3. **コンパイル**（調理）

   - C言語のコードをアセンブリ言語に変換します
   - 文法エラーがあればここで検出されます
   - まだ実行はできません

4. **アセンブル**（盛り付け）

   - アセンブリ言語を機械語（0と1）に変換します
   - オブジェクトファイル（.o または .obj）が作成されます

5. **リンク**（完成）

   - 必要なライブラリと結合します
   - 実行可能ファイルが生成されます
   - Windowsでは .exe ファイル、Unix系では拡張子なし

6. **実行**（食べる）

   - 作成したプログラムを実行します

#### 基本的なコンパイルコマンド
実際のコンパイル方法を見てみましょう。

```bash
# シンプルな方法（すべての処理を一度に）
gcc hello.c -o hello
# hello.c をコンパイルして hello という実行ファイルを作成
# 実行
./hello  # Unix/Linux/macOS
hello    # Windows
# より詳細なオプション付き
gcc -Wall -Wextra -o hello hello.c
# -Wall: すべての警告を表示
# -Wextra: 追加の警告も表示
# -o hello: 出力ファイル名を指定
# 段階的なコンパイル（大きなプログラムで使用）
gcc -c hello.c          # hello.o を作成
gcc -c another.c        # another.o を作成
gcc hello.o another.o -o program  # リンクして実行ファイル作成
```

#### よくあるエラーと対処法
初心者がよく遭遇するエラー。

1. **"gcc: command not found"**

   - コンパイラがインストールされていません
   - PATHが設定されていません

2. **"hello.c: No such file or directory"**

   - ファイル名が間違っています
   - 現在のディレクトリにファイルがありません

3. **"undefined reference to `main'"**

   - main関数が定義されていません
   - C言語のプログラムには必ずmain関数が必要です

##  コンパイル方法
この章では以下のMakefileを使用してコンパイルができます。

```bash
# 全ての例題をコンパイル
make all
# C90準拠でコンパイル
make STANDARD=c90
# C99準拠でコンパイル  
make STANDARD=c99
# C11準拠でコンパイル
make STANDARD=c11
# C17準拠でコンパイル
make STANDARD=c17
# クリーンアップ
make clean
```

##  規格による違い
この章では基本的な環境確認のため、規格による大きな違いはありません。ただし、コンパイラの警告やエラーメッセージに違いが出る場合があります。

##  次の章へ
環境構築が完了したら、[基本文法・Hello World](../basics-syntax/README.md) に進んでください。

##  参考資料

- [GCC公式ドキュメント](https://gcc.gnu.org/documentation.html)
- [C言語規格書 (ISO/IEC 9899:2018)](https://www.iso.org/standard/74528.html)
- [GNU Make マニュアル](https://www.gnu.org/software/make/manual/)
