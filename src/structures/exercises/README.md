# 第13章 演習問題: 構造体

## 演習の目的
- 構造体の定義と使い方を理解する
- 構造体のメンバーアクセス（ドット演算子とアロー演算子）を習得する
- 構造体配列と構造体ポインタの操作を身につける
- ネストした構造体の設計と実装を経験する

## 基礎問題

### 問題13-1: 学生情報管理
学生の情報（ID、名前、年齢、成績）を格納する構造体を定義し、ポインタを使って情報を表示・更新するプログラムを作成してください。

**要件**

- 学生情報を表す構造体を定義
- 学生情報を入力する関数を作成
- 学生情報を表示する関数を作成（ポインタ引数）
- 成績を更新する関数を作成（ポインタ引数）

**実装のヒント**

- 構造体ポインタのメンバーアクセスには->演算子を使用
- 文字列のコピーにはstrcpy()を使用

**期待される出力例:**
```
=== 学生情報管理システム ===
学生情報を入力してください:
ID: 1001
名前: 山田太郎
年齢: 20
成績: 85.5

入力された学生情報:
ID: 1001
名前: 山田太郎
年齢: 20歳
成績: 85.50点

成績を更新します...
新しい成績: 92.0

更新後の学生情報:
ID: 1001
名前: 山田太郎
年齢: 20歳
成績: 92.00点
```

### 問題13-2: 座標計算
2D座標を表す構造体を定義し、2点間の距離を計算する関数をポインタを使って実装してください。

**要件**

- 座標を表す構造体（x, y）を定義
- 2点間の距離を計算する関数を作成（ポインタ引数）
- 座標を移動する関数を作成（ポインタで更新）
- math.hのsqrt関数を使用

**実装のヒント**

- 距離の公式: sqrt((x2-x1)^2 + (y2-y1)^2)
- コンパイル時に-lmオプションが必要

**期待される出力例:**
```
=== 座標計算プログラム ===
点A の座標:
x: 0
y: 0

点B の座標:
x: 3
y: 4

点A(0.00, 0.00) と 点B(3.00, 4.00) の距離: 5.00

点Aを移動します:
x方向の移動量: 2
y方向の移動量: 1

移動後の点A: (2.00, 1.00)
新しい距離: 2.24
```

### 問題13-3: 商品管理
商品情報（コード、名前、価格、在庫）の構造体を作成し、構造体配列で複数商品を管理するプログラムを作成してください。

**要件**

- 商品情報を表す構造体を定義
- 最大10個の商品を管理できる配列を用意
- 商品を追加する関数を作成
- 全商品を表示する関数を作成
- 在庫を更新する関数を作成（商品コードで検索）

**実装のヒント**

- 構造体配列の初期化に注意
- 商品数のカウンタを別途管理

**期待される出力例:**
```
=== 商品管理システム ===
1. 商品追加
2. 商品一覧表示
3. 在庫更新
4. 終了

選択: 1
商品コード: P001
商品名: ノート
価格: 150
在庫数: 50
商品を追加しました。

選択: 1
商品コード: P002
商品名: ペン
価格: 100
在庫数: 100
商品を追加しました。

選択: 2
--- 商品一覧 ---
コード: P001
商品名: ノート
価格: 150円
在庫: 50個

コード: P002
商品名: ペン
価格: 100円
在庫: 100個

選択: 3
更新する商品コード: P001
新しい在庫数: 45
在庫を更新しました。
```

## 応用問題

### 問題13-4: 従業員データベース
従業員情報と部署情報をネストした構造体で管理し、部署別の給与統計を算出するプログラムを作成してください。

**要件**

- 部署情報を表す構造体（部署名、部署コード）
- 従業員情報を表す構造体（ID、名前、部署情報、給与）
- 部署別の平均給与を計算する関数
- 最高給与の従業員を検索する関数
- 構造体ポインタ配列を使用

**実装のヒント**

- ネストした構造体のアクセス方法を理解
- 部署コードで従業員をグループ化

**期待される出力例:**
```
=== 従業員データベース ===
従業員データ:
ID: 1001, 名前: 田中太郎
部署: 営業部 (コード: SALES)
給与: 350000円

ID: 1002, 名前: 鈴木花子
部署: 営業部 (コード: SALES)
給与: 320000円

ID: 1003, 名前: 佐藤次郎
部署: 開発部 (コード: DEV)
給与: 450000円

=== 部署別統計 ===
営業部 (SALES):
- 人数: 2名
- 平均給与: 335000円

開発部 (DEV):
- 人数: 1名
- 平均給与: 450000円

最高給与の従業員:
佐藤次郎 (開発部) - 450000円
```

### 問題13-5: 図書管理システム
本の情報（タイトル、著者、出版年、貸出状況）を管理し、検索・貸出・返却機能を実装してください。

**要件**

- 書籍情報を表す構造体を定義
- 貸出状況を管理（貸出中フラグ、借りた人のID）
- タイトルで検索する関数
- 貸出処理を行う関数
- 返却処理を行う関数
- 貸出中の本一覧を表示する関数

**実装のヒント**

- 部分一致検索にはstrstr()を使用
- 貸出状況は構造体内のフラグで管理

**期待される出力例:**
```
=== 図書管理システム ===
1. 図書検索
2. 貸出処理
3. 返却処理
4. 貸出中一覧
5. 終了

選択: 1
検索するタイトル: プログラミング

検索結果:
1. 「C言語プログラミング入門」 - 山田太郎 (2023年)
   状態: 貸出可能
2. 「プログラミング言語C」 - カーニハン&リッチー (1988年)
   状態: 貸出中 (借主ID: U001)

選択: 2
貸出する本の番号: 1
借りる人のID: U002
「C言語プログラミング入門」を貸出しました。

選択: 4
--- 貸出中の本一覧 ---
1. 「プログラミング言語C」
   借主ID: U001
2. 「C言語プログラミング入門」
   借主ID: U002
```

## チャレンジ問題

### 問題13-6: 成績管理システム
学生と科目の構造体を使って、学生別・科目別の成績統計を管理するプログラムを作成してください。

**要件**

- 科目情報を表す構造体（科目名、科目コード、単位数）
- 成績情報を表す構造体（学生ID、科目コード、点数、評価）
- 学生別の平均点を計算する関数
- 科目別の平均点を計算する関数
- GPA計算機能（A=4.0, B=3.0, C=2.0, D=1.0, F=0.0）

**追加要件**

- CSVファイルからのデータ読み込み機能
- 成績分布のヒストグラム表示

**期待される出力例:**
```
=== 成績管理システム ===
データ読み込み完了: 15件

学生別統計:
学生ID 1001:
- 受講科目数: 3
- 平均点: 83.3
- GPA: 3.33

科目別統計:
プログラミング基礎 (CS101):
- 受講者数: 5
- 平均点: 78.4
- 成績分布:
  A (90-100): ** (2名)
  B (80-89): * (1名)
  C (70-79): * (1名)
  D (60-69): * (1名)
  F (0-59): - (0名)

全体GPA順位:
1. 学生ID 1003: GPA 3.80
2. 学生ID 1001: GPA 3.33
3. 学生ID 1002: GPA 2.95
```

### 問題13-7: 連結リストの実装
構造体を使って単方向連結リストを実装してください。

**要件**

- ノード構造体（データと次のノードへのポインタ）
- リストの先頭に要素を追加
- リストの末尾に要素を追加
- 特定の値を持つノードを削除
- リスト全体を表示
- メモリリークを防ぐ適切な解放処理

**実装のヒント**

- 自己参照構造体の定義方法を理解
- malloc/freeを使った動的メモリ管理

**期待される出力例:**
```
=== 連結リスト操作 ===
1. 先頭に追加
2. 末尾に追加
3. 削除
4. 表示
5. 終了

選択: 1
値: 10
先頭に10を追加しました。

選択: 2
値: 20
末尾に20を追加しました。

選択: 1
値: 5
先頭に5を追加しました。

選択: 4
リスト: 5 -> 10 -> 20 -> NULL

選択: 3
削除する値: 10
10を削除しました。

選択: 4
リスト: 5 -> 20 -> NULL

選択: 5
メモリを解放しています...
終了しました。
```

## 提出方法
1. 各演習問題ごとに独立したCファイルを作成
2. ファイル名は `ex13_1.c`, `ex13_2.c` のような形式で
3. 構造体の設計意図をコメントで説明
4. メモリ管理を適切に行う（特に動的メモリを使用する場合）

## 学習のポイント
- 構造体は関連するデータをまとめる強力な機能
- ポインタ経由のアクセスでは->演算子を使用
- 構造体の引数渡しは通常ポインタで行う（効率のため）
- ネストした構造体で複雑なデータ構造を表現可能

## 次の章へ

演習問題お疲れさまでした！次は[第14章: 関数ポインタ](../../function-pointers/)に進みましょう。