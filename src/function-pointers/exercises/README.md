# 第12章 演習問題: 関数ポインタ

## 演習の目的
- 関数ポインタの基本概念を理解する
- コールバック関数の実装方法を習得する
- 関数ポインタ配列を活用した動的関数選択を学ぶ
- 実行時関数切り替えシステムの設計を理解する

## 演習問題

### 演習12-1: 関数ポインタの基本操作
関数ポインタを使って複数の関数を動的に呼び出すプログラムを作成してください。

**要件:**
- 2つの整数を受け取り、結果を返す関数を複数定義する
- 関数ポインタを使ってこれらの関数を呼び出す
- 関数ポインタ配列を使った実装も含める

**実装すべき関数:**
- `int maximum(int a, int b)` - 大きい方の値を返す
- `int minimum(int a, int b)` - 小さい方の値を返す  
- `int power(int a, int b)` - aのb乗を返す（簡単な実装で可）

**ファイル名:** `ex12_1_basic_function_pointer.c`

### 演習12-2: 関数選択システム
文字に基づいて関数を選択し実行するシステムを実装してください。

**要件:**
- 文字（'+', '-', '*', '/'など）に基づいて関数を選択
- 選択された関数を実行して結果を表示
- 無効な文字が指定された場合のエラーハンドリング
- 構造体を使った関数ポインタ管理

**ファイル名:** `ex12_2_function_selector.c`

### 演習12-3: 配列処理のコールバック
コールバック関数を使って配列の各要素に異なる処理を適用するプログラムを作成してください。

**要件:**
- 整数配列を処理する関数を複数定義
- コールバック関数として配列処理関数に渡す
- 処理前後の配列の状態を表示
- 動的な処理選択機能

**実装すべき処理:**
- 各要素を倍にする
- 各要素から1を引く
- 各要素の符号を反転する

**ファイル名:** `ex12_3_array_callback.c`

### 演習12-4: 関数ポインタ配列を使った計算機
関数ポインタ配列を使用した計算機プログラムを作成してください。

**要件:**
- 関数ポインタの配列を定義
- インデックスを指定して演算を選択
- 複数の演算を連続で実行可能
- 演算履歴を表示する機能
- 統計情報の収集と表示

**実装すべき演算:**
- 加算、減算、乗算、除算
- ゼロ除算のエラーハンドリング

**ファイル名:** `ex12_4_calculator_function_array.c`

## チャレンジ問題

### チャレンジ12-5: ソートアルゴリズム選択システム
異なるソートアルゴリズムを関数ポインタで切り替えるシステムを作成してください。

**要件:**
- バブルソート、選択ソート、挿入ソートを実装
- 比較関数も関数ポインタで指定（昇順/降順）
- ソート前後の配列状態を表示
- アルゴリズムの性能比較機能

**ファイル名:** `ex12_5_sort_algorithms.c`

### チャレンジ12-6: イベント駆動システム
コールバック関数を使ったイベント駆動システムを実装してください。

**要件:**
- 複数種類のイベント（開始、停止、エラー、警告）
- イベントタイプごとに異なるハンドラーを登録
- イベント発生時に適切なハンドラーを呼び出し
- イベントの優先度機能

**ファイル名:** `ex12_6_event_system.c`

## 提出方法

1. 各演習問題ごとに独立したCファイルを作成
2. ファイル名は `ex12_1.c`, `ex12_2.c` のような形式で
3. コメントで問題番号と簡単な説明を記載
4. C90規格でコンパイルできることを確認
5. C99版も作成し、`_c99.c` サフィックスを付ける

## コンパイル例

### C90準拠
```bash
gcc -std=c90 -Wall -Wextra -pedantic ex12_1_basic_function_pointer.c -o ex12_1_basic_function_pointer
```

### C99準拠
```bash
gcc -std=c99 -Wall -Wextra -pedantic ex12_1_basic_function_pointer_c99.c -o ex12_1_basic_function_pointer_c99
```

## 学習のポイント

### 関数ポインタの基本
1. **宣言**: `int (*func_ptr)(int, int);`
2. **初期化**: `func_ptr = function_name;`
3. **呼び出し**: `result = func_ptr(a, b);`
4. **配列**: `int (*operations[])(int, int) = {add, sub, mul};`

### コールバック関数
1. **概念**: 関数を引数として渡す仕組み
2. **活用**: 動的な処理選択、カスタマイズ可能な処理
3. **設計**: 関数ポインタを引数に取る関数の実装

### 実用的なテクニック
1. **関数テーブル**: 構造体による関数ポインタ管理
2. **エラーハンドリング**: 無効な関数ポインタの検出
3. **状態管理**: 関数ポインタによる状態遷移
4. **性能**: 関数ポインタ使用時のオーバーヘッド考慮

## 注意事項

- 関数ポインタは初期化前に使用しない
- 型の一致を厳密に確認する
- NULL ポインタチェックを忘れずに
- デバッグ時は関数名の確認が困難な場合がある

## 実用的な応用

これらの技術は以下のような場面で使用されます。

- **GUI フレームワーク**: イベントハンドラ
- **組み込みシステム**: 割り込みハンドラ
- **ゲーム開発**: 状態管理、AI 行動パターン
- **システムプログラミング**: プラグインシステム

## 次のステップ

この章をマスターしたら、次の章に進みましょう。
- [第13章: 高度なプログラミング技法](../advanced/)
- 関数ポインタを活用したより複雑なシステム設計
- マルチスレッドプログラミングでの関数ポインタ活用