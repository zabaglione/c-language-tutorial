# データ型・変数・スコープ 演習解答

この章の演習問題の解答例を示します。各解答にはC90準拠版とC99準拠版を用意し、両者の違いを学習できるようにしています。

## 演習解答一覧

### 演習3-1: 変数宣言と初期化
**ファイル:** [`ex3_1_variable_declaration.c`](ex3_1_variable_declaration.c) | [C99版](ex3_1_variable_declaration_c99.c)

さまざまなデータ型の変数を宣言し、初期化して出力するプログラムです。

**学習内容:**
- 各データ型の適切な宣言方法
- 初期化の重要性
- printf関数での型に応じた書式指定子の使用
- sizeof演算子によるサイズ確認
- 定数の定義と使用

### 演習3-2: 四則演算計算機
**ファイル:** [`ex3_2_calculator.c`](ex3_2_calculator.c) | [C99版](ex3_2_calculator_c99.c)

2つの数値を変数に格納し、四則演算の結果を表示するプログラムです。

**学習内容:**
- 整数演算と実数演算の違い
- 四則演算子 (+, -, *, /, %) の使い方
- 整数除算では小数点以下が切り捨てられる
- 剰余演算子(%)は整数のみで使用可能
- 混合演算での自動型変換
- 明示的型変換 (キャスト) の使用

### 演習3-3: データ型サイズの確認
**ファイル:** [`ex3_3_sizeof_demo.c`](ex3_3_sizeof_demo.c) | [C99版](ex3_3_sizeof_demo_c99.c)

sizeof演算子を使って、各データ型のサイズを表示するプログラムです。

**学習内容:**
- sizeof演算子でデータ型や変数のサイズを確認
- limits.hヘッダで整数型の範囲定数を取得
- float.hヘッダで浮動小数点型の特性を取得
- 配列のサイズと要素数の計算方法
- ポインタのサイズはシステム依存
- C99の固定幅整数型（stdint.h）

### 演習3-4: 型変換の理解
**ファイル:** [`ex3_4_type_conversion.c`](ex3_4_type_conversion.c) | [C99版](ex3_4_type_conversion_c99.c)

整数除算と実数除算の違いを確認し、型変換について学習するプログラムです。

**学習内容:**
- 整数除算は小数点以下が切り捨てられる
- 暗黙の型変換は自動的に行われる
- 明示的な型変換（キャスト）で強制的に変換できる
- 型変換には優先順位がある
- charとintの間でASCII値による変換が可能
- オーバーフローは上位ビットの切り捨てで発生

### 演習3-5: スコープの実験
**ファイル:** [`ex3_5_scope_experiment.c`](ex3_5_scope_experiment.c) | [C99版](ex3_5_scope_experiment_c99.c)

グローバル変数とローカル変数を使い分け、スコープの概念を学習するプログラムです。

**学習内容:**
- グローバル変数はファイル全体でアクセス可能
- ローカル変数は宣言されたブロック内でのみ有効
- 静的ローカル変数は関数呼出間で値を保持
- static指定子でファイル内限定のグローバル変数を作成可能
- 内側のスコープで同名変数を宣言すると外側を隠蔽
- ブロックスコープは {} で区切られた範囲

### 演習3-6: 定数の活用
**ファイル:** [`ex3_6_constants_demo.c`](ex3_6_constants_demo.c) | [C99版](ex3_6_constants_demo_c99.c)

constと#defineを使って定数を定義し、物理計算に使用するプログラムです。

**学習内容:**
- #defineによるマクロ定数の定義
- const変数による定数の定義
- マクロ関数の作成と使用
- 物理計算での定数の活用
- 定数の命名規則（大文字、アンダースコア）
- #define vs const の違い

## C90とC99の主な違い

### C90の特徴
- 変数宣言は関数やブロックの先頭で行う必要がある
- /* */ 形式のコメントのみ使用可能
- 配列サイズは定数式である必要がある
- long long型は使用できない

### C99の新機能
- 変数を使用箇所で宣言可能
- // 形式のコメントが使用可能
- for文内で変数宣言可能 (for (int i = 0; ...))
- 可変長配列（VLA）をサポート
- long long型の追加（64ビット整数）
- 固定幅整数型（int8_t, int16_t, int32_t, int64_t等）

## コンパイル方法

### C90準拠でコンパイル
```bash
gcc -std=c90 -Wall -Wextra -pedantic filename.c -o output
```

### C99準拠でコンパイル
```bash
gcc -std=c99 -Wall -Wextra -pedantic filename.c -o output
```

### 数学ライブラリが必要な場合
```bash
gcc -std=c90 -Wall -Wextra -pedantic filename.c -o output -lm
```

## 重要な学習ポイント

### データ型の選択基準
- **char**: 文字データ、小さな整数
- **short**: 小さな整数（メモリ節約）
- **int**: 一般的な整数計算
- **long**: 大きな整数
- **unsigned**: 負の値を扱わない場合
- **float**: 精度をそれほど要求しない実数
- **double**: 高精度な実数計算

### 変数のスコープと生存期間
- **自動変数**: ブロック開始時に作成、終了時に破棄
- **静的変数**: プログラム開始時に作成、終了まで存続
- **グローバル変数**: プログラム全体で存続

### 定数の使い分け
- **#define**: プリプロセッサによる文字列置換、型情報なし
- **const**: 型付き定数、デバッガで値確認可能、スコープあり

## チャレンジ問題

### 演習3-7: 温度変換プログラム
**ファイル:** [`ex3_7_temperature_converter.c`](ex3_7_temperature_converter.c) | [C99版](ex3_7_temperature_converter_c99.c)

摂氏・華氏・ケルビンの温度単位を相互変換するプログラムです。

**学習内容:**
- #defineマクロによる定数の定義
- 浮動小数点演算の精度管理
- 物理的な意味を持つ計算の実装
- 複数の単位系の相互変換
- 科学技術計算での定数活用

## よくある間違いと対策

### 1. 初期化忘れ
```c
/* NG: 初期化せずに使用 */
int count;
printf("%d\n", count);  /* 未定義値が出力される */

/* OK: 初期化してから使用 */
int count = 0;
printf("%d\n", count);
```

### 2. 整数除算の結果
```c
/* NG: 期待した結果にならない */
int result = 5 / 2;     /* 結果: 2 */

/* OK: 実数除算を使用 */
double result = 5.0 / 2.0;  /* 結果: 2.5 */
```

### 3. 型の範囲超過
```c
/* NG: charの範囲を超える */
char big_num = 300;     /* オーバーフロー */

/* OK: 適切な型を使用 */
int big_num = 300;
```

これらの演習を通じて、C言語の基本データ型、変数のスコープ、定数の活用方法を習得してください。