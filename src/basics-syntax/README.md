# 基本構文
##  対応C規格
- **主要対象:** C90
- **学習内容:** プログラムの基本構造、main関数、printf関数
##  学習目標
この章を完了すると、以下のことができるようになります：
- C言語プログラムの基本構造を理解する
- main関数の役割を理解する
- printf関数を使った文字列出力ができる
- コメントの書き方を覚える
- 基本的なエスケープシーケンスを使える
##  概要と詳細
### はじめてのC言語プログラム
プログラミングの学習は「Hello, World!」と画面に表示するプログラムから始まるのが伝統です。この章では、最初のC言語プログラムを作成し、その構造を詳しく学びます。
### プログラムの基本構造 
まず、最もシンプルなC言語プログラムを見てみましょう：
```c
/*
 * ファイル名: hello_world_c99.c
 * 説明: C言語の最も基本的なプログラム（C99版）
 * 規格: C99準拠
 */
#include <stdio.h>
int main(void)
{
    printf("Hello, World!\n");
    return 0;
}
/*
C99での変更点:
- この基本的なプログラムでは、C90版と同一内容
- より複雑なプログラムでは以下のC99機能を活用可能:
  - forループ内での変数宣言
  - 必要な時点での変数宣言
  - C99特有のデータ型（long long, _Bool等）
  - 配列の可変長宣言など
*/
```
このたった6行のプログラムにも、C言語の重要な要素がすべて含まれています。料理のレシピのように、各行には重要な役割があります。
#### 各部分の詳しい説明
1. **プリプロセッサ指令** (`#include <stdio.h>`)
   - プログラムの「準備」をする行です
   - `stdio.h`（Standard Input/Output Header）は「標準入出力ヘッダー」という意味
   - `printf`のような入出力関数を使うために必要です
   - 例えるなら、料理を始める前に必要な道具を準備するようなものです
2. **main関数** (`int main(void)`)
   - C言語プログラムの「心臓部」です
   - プログラムは必ずここから実行が始まります
   - `int`は「整数を返す」という意味
   - `void`は「引数を受け取らない」という意味
   - どんなに大きなプログラムでも、main関数は1つだけです
3. **関数本体**（`{` と `}` で囲まれた部分）
   - 実際の処理を書く場所です
   - `{`（開き波括弧）で始まり、`}`（閉じ波括弧）で終わります
   - この中に書かれた命令が順番に実行されます
   - インデント（字下げ）をして読みやすくするのが慣習です
4. **処理文** (`printf("Hello, World!\n");`)
   - 実際に何かをする命令です
   - `printf`は画面に文字を表示する関数
   - 文の最後には必ず`;`（セミコロン）を付けます
   - これを忘れるとコンパイルエラーになります
5. **return文** (`return 0;`)
   - プログラムの終了を示します
   - `0`は「正常終了」を意味する特別な数字
   - エラーが発生した場合は0以外の数字を返すことがあります
#### なぜこの構造なのか？
初心者の方は「なぜこんなに複雑なの？」と思うかもしれません。実は、この構造には理由があります：
- **#include**: 車輪の再発明を避けるため
  - すでに作られた便利な機能を使えるようにします
  - printf関数も誰かが作ってくれた機能です
- **main関数**: プログラムの開始点を明確にするため
  - コンピュータがどこから実行すればよいか迷わないようにします
- **波括弧{}**: プログラムの範囲を明確にするため
  - どこからどこまでがmain関数なのかを示します
- **セミコロン;**: 文の終わりを明確にするため
  - 日本語の「。」のような役割です
### main関数の詳細 
main関数はプログラムの**エントリーポイント**（実行開始点）です。野球で言えばピッチャーマウンド、演劇で言えば主役が最初に登場する場所のようなものです。
#### main関数の2つの形式
C言語のmain関数には主に2つの書き方があります：
**1. 基本形式（引数なし）:**
```c
int main(void)
{
    printf("Hello from main!\n");
    return 0;
}
```
この形式は最もシンプルで、初心者の学習に適しています。`void`は「何も受け取らない」という意味です。
**2. コマンドライン引数を受け取る形式:**
```c
int main(int argc, char *argv[])
{
    printf("プログラム名: %s\n", argv[0]);
    if (argc > 1) {
        printf("引数1: %s\n", argv[1]);
    }
    return 0;
}
```
この形式は、プログラム実行時に追加情報を受け取りたい場合に使います。例えば：
```bash
./myprogram file.txt -v
```
このように実行すると、`file.txt`や`-v`という情報をプログラム内で使えます。
（詳しくは後の章で学習します）
#### 戻り値の意味と重要性
main関数の`return`は、プログラムがどのように終了したかをOSに伝える重要な役割があります：
- **0**: 「すべて正常に終わりました」という合図
  - 成功を示す世界共通の値です
  - プログラムが期待通りに動作したことを意味します
- **0以外**: 「何か問題がありました」という合図
  - 1, 2, 3...など、異なる数字で異なるエラーを表現できます
  - 例：1 = ファイルが見つからない、2 = メモリ不足など
#### なぜ戻り値が重要なのか？
プログラムは単独で動くだけでなく、他のプログラムと連携することがあります：
```bash
# プログラムAが成功したらプログラムBを実行
./programA && ./programB
# プログラムCが失敗したらエラーメッセージを表示
./programC || echo "エラーが発生しました"
```
このような連携を可能にするのが、main関数の戻り値です。
#### よくある疑問
**Q: なぜ`int`なの？**
A: 戻り値として整数（integer）を返すためです。成功/失敗を数字で表現します。
**Q: `void main()`と書いている例を見たけど？**
A: 古い書き方で、現在は推奨されません。必ず`int main()`を使いましょう。
**Q: return 0;を忘れたらどうなる？**
A: C99以降では自動的に0が返されますが、明示的に書くことを推奨します。
### printf関数 
printf関数は画面に文字を表示するための関数です。「print formatted（フォーマット付き出力）」の略で、単純な文字列だけでなく、数値や変数の値も表示できる強力な機能です。
#### 基本的な使い方
最もシンプルな使い方から始めましょう：
```c
printf("Hello, World!\n");
```
この1行で「Hello, World!」と表示して改行します。`\n`は改行を意味する特殊な記号です。
#### なぜprintf関数を使うのか？
コンピュータとの対話には出力が欠かせません：
- 計算結果を確認したい
- プログラムの動作状況を知りたい
- エラーメッセージを表示したい
これらすべてにprintf関数を使います。
#### フォーマット指定子（変数の値を表示する魔法）
printf関数の真の力は、変数の値を表示できることです。`%`記号を使った「フォーマット指定子」がその鍵です：
| 指定子 | データ型 | 説明 | 例 |
|--------|----------|------|-----|
| `%d` | int | 整数（decimal） | `printf("年齢は%d歳です", 20);` → 年齢は20歳です |
| `%c` | char | 1文字（character） | `printf("成績は%cです", 'A');` → 成績はAです |
| `%s` | char* | 文字列（string） | `printf("名前は%sです", "太郎");` → 名前は太郎です |
| `%f` | double | 小数（float） | `printf("円周率は%fです", 3.14);` → 円周率は3.140000です |
#### 複数の値を同時に表示
printf関数では、複数の値を一度に表示できます：
```c
int age = 20;
double height = 170.5;
printf("年齢: %d歳、身長: %.1fcm\n", age, height);
/* 出力: 年齢: 20歳、身長: 170.5cm */
```
`%.1f`は「小数点以下1桁まで表示」という意味です。
#### エスケープシーケンス（特殊文字の表現）
画面に表示できない特殊な文字を表現するための記号です。`\`（バックスラッシュ）で始まります：
| シーケンス | 意味 | 使用例と効果 |
|------------|------|------------|
| `\n` | 改行（newline） | `printf("1行目\n2行目");` → 2行に分けて表示 |
| `\t` | タブ（tab） | `printf("名前\t年齢");` → 名前と年齢の間に大きな空白 |
| `\"` | ダブルクォート | `printf("彼は\"天才\"だ");` → 彼は"天才"だ |
| `\\` | バックスラッシュ | `printf("C:\\Program Files");` → C:\Program Files |
#### よくある使用例
```c
/* 基本的な挨拶 */
printf("こんにちは！\n");
/* 計算結果の表示 */
int a = 10, b = 20;
printf("%d + %d = %d\n", a, b, a + b);  /* 10 + 20 = 30 */
/* 表形式での表示 */
printf("商品名\t\t価格\t個数\n");
printf("りんご\t\t100円\t3個\n");
printf("みかん\t\t80円\t5個\n");
/* エラーメッセージ */
printf("エラー: ファイル \"%s\" が見つかりません。\n", "data.txt");
```
#### 初心者がよく間違えるポイント
1. **%の数と値の数が一致しない**
   ```c
   /* NG: %dが2つあるのに値が1つしかない */
   printf("%d + %d = ", 10);  /* エラーまたは予期しない動作 */
   
   /* OK: 正しい書き方 */
   printf("%d + %d = %d", 10, 20, 30);
   ```
2. **\nを忘れる**
   ```c
   printf("Hello");
   printf("World");  /* HelloWorld と続けて表示される */
   
   /* 改行したい場合 */
   printf("Hello\n");
   printf("World\n");
   ```
3. **%と変数の型が一致しない**
   ```c
   double pi = 3.14;
   /* NG: doubleに%dを使用 */
   printf("円周率は%dです", pi);  /* おかしな値が表示される */
   
   /* OK: doubleには%f */
   printf("円周率は%fです", pi);
   ```
### コメント 
プログラムに説明を追加するためのコメント記法：
#### C90スタイル
```c
/* これは複数実行にわたる
   コメントです */
/* 1行コメント */
```
#### C99以降のスタイル
```c
// これは1行コメントです（C99以降）
```
**重要:** この章ではC90準拠のため、`/* */` スタイルを使用します。
### 基本的なプログラム例 
#### 例: 単純な文字列出力
```c
/*
 * ファイル名: hello_world_c99.c
 * 説明: C言語の最も基本的なプログラム（C99版）
 * 規格: C99準拠
 */
#include <stdio.h>
int main(void)
{
    printf("Hello, World!\n");
    return 0;
}
/*
C99での変更点:
- この基本的なプログラムでは、C90版と同一内容
- より複雑なプログラムでは以下のC99機能を活用可能:
  - forループ内での変数宣言
  - 必要な時点での変数宣言
  - C99特有のデータ型（long long, _Bool等）
  - 配列の可変長宣言など
*/
```
#### 例: 複数実行の出力
```c
/*
 * ファイル名: formatted_output_c99.c
 * 説明: printf関数のさまざまなフォーマット指定子を学習（C99版）
 * 規格: C99準拠
 */
#include <stdio.h>
int main(void)
{
    /* 基本的な文字列出力 */
    printf("=== C言語フォーマット出力 ===\n");
    /* 整数データの出力 */
    int positive_num = 42;  /* C99：必要な時点で変数宣言 */
    printf("整数: %d\n", positive_num);
    
    int negative_num = -123;  /* C99：必要な時点で変数宣言 */
    printf("負の整数: %d\n", negative_num);
    /* 文字データの出力 */
    char letter = 'A';  /* C99：必要な時点で変数宣言 */
    printf("文字: %c\n", letter);
    printf("文字コード: %c\n", 65); /* Aのアスキーコード */
    /* 文字列の出力 */
    printf("文字列: %s\n", "Hello, World!");
    /* 浮動小数点数の出力 */
    double pi = 3.14159;  /* C99：必要な時点で変数宣言 */
    printf("浮動小数点数: %f\n", pi);
    printf("小数点以下2桁: %.2f\n", pi);
    /* エスケープシーケンスの使用 */
    printf("\n--- エスケープシーケンス ---\n");
    printf("改行\nとタブ\tの使用例：\n");
    printf("項目1\t項目2\t項目3\n");
    printf("値A\t値B\t値C\n");
    /* 特殊文字の表示 */
    printf("\n--- 特殊文字の表示 ---\n");
    printf("ダブルクォート: \"Hello\"\n");
    printf("バックスラッシュ: C:\\Program Files\\\n");
    /* フォーマット指定子の組み合わせ */
    printf("\n--- 複合表示 ---\n");
    char name[] = "田中太郎";  /* C99：必要な時点で変数宣言 */
    int age = 25;  /* C99：必要な時点で変数宣言 */
    double height = 175.5;  /* C99：必要な時点で変数宣言 */
    printf("名前: %s, 年齢: %d歳, 身長: %.1fcm\n", name, age, height);
    return 0;
}
/*
C99での変更点:
- 各変数を必要な時点で宣言
- より読みやすいコード構造
- 変数の役割がより明確になる配置
- 配列の初期化方法も活用
学習ポイント（C90版と共通）:
1. printf関数の基本的な使用方法
2. 各種データ型の書式指定子（%d, %c, %s, %f）
3. エスケープシーケンス（\n, \t, \", \\）
4. フィールド幅や精度の指定（%.2f等）
5. 複数の値を組み合わせた出力
*/
```
#### 例: エスケープシーケンスの使用
```c
/*
 * ファイル名: formatted_output_c99.c
 * 説明: printf関数のさまざまなフォーマット指定子を学習（C99版）
 * 規格: C99準拠
 */
#include <stdio.h>
int main(void)
{
    /* 基本的な文字列出力 */
    printf("=== C言語フォーマット出力 ===\n");
    /* 整数データの出力 */
    int positive_num = 42;  /* C99：必要な時点で変数宣言 */
    printf("整数: %d\n", positive_num);
    
    int negative_num = -123;  /* C99：必要な時点で変数宣言 */
    printf("負の整数: %d\n", negative_num);
    /* 文字データの出力 */
    char letter = 'A';  /* C99：必要な時点で変数宣言 */
    printf("文字: %c\n", letter);
    printf("文字コード: %c\n", 65); /* Aのアスキーコード */
    /* 文字列の出力 */
    printf("文字列: %s\n", "Hello, World!");
    /* 浮動小数点数の出力 */
    double pi = 3.14159;  /* C99：必要な時点で変数宣言 */
    printf("浮動小数点数: %f\n", pi);
    printf("小数点以下2桁: %.2f\n", pi);
    /* エスケープシーケンスの使用 */
    printf("\n--- エスケープシーケンス ---\n");
    printf("改行\nとタブ\tの使用例：\n");
    printf("項目1\t項目2\t項目3\n");
    printf("値A\t値B\t値C\n");
    /* 特殊文字の表示 */
    printf("\n--- 特殊文字の表示 ---\n");
    printf("ダブルクォート: \"Hello\"\n");
    printf("バックスラッシュ: C:\\Program Files\\\n");
    /* フォーマット指定子の組み合わせ */
    printf("\n--- 複合表示 ---\n");
    char name[] = "田中太郎";  /* C99：必要な時点で変数宣言 */
    int age = 25;  /* C99：必要な時点で変数宣言 */
    double height = 175.5;  /* C99：必要な時点で変数宣言 */
    printf("名前: %s, 年齢: %d歳, 身長: %.1fcm\n", name, age, height);
    return 0;
}
/*
C99での変更点:
- 各変数を必要な時点で宣言
- より読みやすいコード構造
- 変数の役割がより明確になる配置
- 配列の初期化方法も活用
学習ポイント（C90版と共通）:
1. printf関数の基本的な使用方法
2. 各種データ型の書式指定子（%d, %c, %s, %f）
3. エスケープシーケンス（\n, \t, \", \\）
4. フィールド幅や精度の指定（%.2f等）
5. 複数の値を組み合わせた出力
*/
```
##  コンパイル方法
この章では以下のMakefileを使用してコンパイルができます：
```bash
# 全ての例題をコンパイル
make all
# 特定のプログラムをコンパイル
make hello_world
# 実行
make run
# クリーンアップ
make clean
```
##  規格による違い
### C90での制限事項
- コメントは `/* */` 形式のみ
- 変数宣言は関数やブロックの先頭で実行う
- forループ内での変数宣言は不可
### C99以降の拡張
- `//` 形式のコメント追加
- forループ内での変数宣言が可能
- 複合リテラル等の新機能
##  次の章へ
基本文法を理解したら、[データ型と変数](../data-types/README.md) に進んでください。
##  参考資料
- [printf関数リファレンス](https://ja.cppreference.com/w/c/io/fprintf)
- [エスケープシーケンス一覧](https://ja.cppreference.com/w/c/language/escape)
- [C90規格仕様](https://www.iso.org/standard/17782.html)
